<h2 class='titles'>Challenges</h2>

<% @challenge.each do |challenge| %>
	<div class="box">
	<ul id='challenge_profile'>
		<li id='title'><%= challenge.title %> <% if challenge.top_three_flag%><span id='live_flag'>Live</span><% end %></li>
		<div id='challenge_body'>
		<li>Category: 
			<% case challenge.category when 'OMS' %>
				<%= link_to "Order Management System", "/category_search/#{challenge.id}/#{challenge.category}" %>
				<% when 'db' %>
				<%= link_to "Databases", "/category_search/#{challenge.id}/#{challenge.category}" %>
				<% when 'example2' %>
				<%= link_to "Test", "/category_search/#{challenge.id}/#{challenge.category}" %>
				<% end %> 
		</li>
		<li>Description: <%= challenge.description %></li>
	</div>
		<button><li><%= link_to "Add Solution", "/challenges/#{challenge.id}/solutions/add_solution" %></li></button>
		<button><li><%= link_to "View Solutions", "/challenges/#{challenge.id}/solutions" %></li></button>
	<% if (current_user.acct_type == 'admin' && challenge.top_three_flag == false) %>
		<li><%= button_to "Go Live", "/challenges/add_top_three?id=#{challenge.id}" %></li>
	<% elsif (current_user.acct_type == 'admin' && challenge.top_three_flag == true) %>
		<li><%= button_to "Remove live flag", "/challenges/add_top_three?id=#{challenge.id}" %></li>
	<% end %>
	<% if current_user.following_challenge?(challenge) && challenge.top_three_flag == true %>
		<%= form_for(current_user.relationships.find_by_followed_id(challenge),
         html: { method: :delete }) do |f| %>
 		 <%= f.submit "Unfollow", class: "btn btn-large" %>
			<% end %>
	<% elsif challenge.top_three_flag == true %>
		<%= form_for(current_user.relationships.build(followed_id: challenge.id)) do |f| %>
  			<div><%= f.hidden_field :followed_id %></div>
 		 <%= f.submit "Follow", class: "btn btn-large btn-primary" %>
		<% end %>
		<% end %>
	</ul>
	</div>
<% end %>